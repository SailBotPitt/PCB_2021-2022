Version 4
SHEET 1 1312 1288
WIRE -160 -240 -608 -240
WIRE -96 -240 -160 -240
WIRE -64 -240 -96 -240
WIRE 64 -240 32 -240
WIRE 144 -240 64 -240
WIRE 288 -240 256 -240
WIRE 352 -240 288 -240
WIRE 384 -240 352 -240
WIRE 512 -240 480 -240
WIRE 592 -240 512 -240
WIRE 752 -240 704 -240
WIRE 816 -240 752 -240
WIRE 848 -240 816 -240
WIRE 976 -240 944 -240
WIRE 1056 -240 976 -240
WIRE -96 -224 -96 -240
WIRE 352 -224 352 -240
WIRE 816 -224 816 -240
WIRE -32 -144 -96 -144
WIRE -16 -144 -16 -176
WIRE -16 -144 -32 -144
WIRE 416 -144 352 -144
WIRE 432 -144 432 -176
WIRE 432 -144 416 -144
WIRE 880 -144 816 -144
WIRE 896 -144 896 -176
WIRE 896 -144 880 -144
WIRE 64 -128 64 -240
WIRE 144 -128 144 -240
WIRE 512 -128 512 -240
WIRE 592 -128 592 -240
WIRE 976 -128 976 -240
WIRE 1056 -128 1056 -240
WIRE -160 -112 -160 -240
WIRE 288 -112 288 -240
WIRE 752 -112 752 -240
WIRE -32 -96 -32 -144
WIRE 416 -80 416 -144
WIRE 880 -80 880 -144
WIRE -160 -16 -160 -32
WIRE -32 -16 -32 -32
WIRE -32 -16 -160 -16
WIRE 288 -16 288 -32
WIRE 416 -16 288 -16
WIRE 752 -16 752 -32
WIRE 880 -16 752 -16
WIRE -160 0 -160 -16
WIRE 288 0 288 -16
WIRE 752 0 752 -16
WIRE -160 160 -160 80
WIRE -144 160 -160 160
WIRE 0 160 0 -64
WIRE 0 160 -64 160
WIRE 64 160 64 128
WIRE 64 160 0 160
WIRE 144 160 144 16
WIRE 144 160 64 160
WIRE 192 160 144 160
WIRE 288 160 288 80
WIRE 304 160 288 160
WIRE 448 160 448 -48
WIRE 448 160 384 160
WIRE 512 160 512 128
WIRE 512 160 448 160
WIRE 592 160 592 16
WIRE 592 160 512 160
WIRE 688 160 592 160
WIRE 752 160 752 80
WIRE 768 160 752 160
WIRE 912 160 912 -48
WIRE 912 160 848 160
WIRE 976 160 976 128
WIRE 976 160 912 160
WIRE 1056 160 1056 16
WIRE 1056 160 976 160
WIRE 1200 160 1056 160
WIRE -608 304 -608 -240
WIRE -400 304 -608 304
WIRE -176 304 -400 304
WIRE 0 304 -80 304
WIRE 96 304 0 304
WIRE 192 304 192 160
WIRE 192 304 176 304
WIRE 256 304 256 -240
WIRE 256 304 192 304
WIRE 400 304 256 304
WIRE 592 304 560 304
WIRE 688 304 688 160
WIRE 688 304 672 304
WIRE 704 304 704 -240
WIRE 704 304 688 304
WIRE 864 304 704 304
WIRE 1056 304 1040 304
WIRE 1136 304 1120 304
WIRE 1200 304 1200 160
WIRE 1200 304 1136 304
WIRE 400 320 400 304
WIRE 560 320 560 304
WIRE 560 320 496 320
WIRE 576 320 560 320
WIRE 864 320 864 304
WIRE 1040 320 1040 304
WIRE 1040 320 960 320
WIRE -96 368 -96 352
WIRE -80 368 -96 368
WIRE 0 368 0 304
WIRE 480 384 480 368
WIRE 496 384 480 384
WIRE 576 384 576 320
WIRE 944 384 944 368
WIRE 960 384 944 384
WIRE 1040 384 1040 320
WIRE 416 416 -160 416
WIRE 880 416 416 416
WIRE -400 432 -400 304
WIRE -160 448 -160 416
WIRE -160 448 -256 448
WIRE -96 464 -96 368
WIRE 480 480 480 384
WIRE 944 480 944 384
WIRE -400 528 -400 512
WIRE -256 528 -256 512
WIRE -256 528 -400 528
WIRE -400 544 -400 528
WIRE -160 544 -160 448
WIRE -144 544 -160 544
WIRE 416 560 416 416
WIRE 432 560 416 560
WIRE 880 560 880 416
WIRE 896 560 880 560
WIRE 352 656 304 656
WIRE 304 672 304 656
WIRE 352 672 352 656
WIRE -400 704 -400 624
WIRE -384 704 -400 704
WIRE -224 704 -224 480
WIRE -224 704 -304 704
WIRE 304 768 304 752
WIRE 304 768 128 768
WIRE 128 784 128 768
WIRE 304 800 304 768
WIRE -608 896 -608 304
WIRE -448 896 -608 896
WIRE 128 896 128 864
WIRE 128 896 -368 896
WIRE 224 896 128 896
WIRE 576 896 384 896
WIRE 1184 896 656 896
WIRE 1200 896 1200 304
WIRE 1200 896 1184 896
FLAG -96 640 0
FLAG 480 656 0
FLAG 944 656 0
FLAG 352 672 0
FLAG 1184 896 0
SYMBOL res -176 -128 R0
SYMATTR InstName R1
SYMATTR Value 20k
SYMBOL res -176 -16 R0
SYMATTR InstName R2
SYMATTR Value 20k
SYMBOL diode 48 -128 R0
SYMATTR InstName D9
SYMBOL diode 48 -64 R0
SYMATTR InstName D10
SYMBOL diode 48 0 R0
SYMATTR InstName D11
SYMBOL diode 48 64 R0
SYMATTR InstName D12
SYMBOL pnp 32 -176 M270
SYMATTR InstName Q4
SYMBOL res -112 -240 R0
SYMATTR InstName R9
SYMATTR Value 1k
SYMBOL res 128 -144 R0
SYMATTR InstName R10
SYMATTR Value 330
SYMBOL LED 128 -48 R0
SYMATTR InstName D13
SYMBOL res -48 144 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R13
SYMATTR Value 20k
SYMBOL res 272 -128 R0
SYMATTR InstName R3
SYMATTR Value 20k
SYMBOL res 272 -16 R0
SYMATTR InstName R4
SYMATTR Value 20k
SYMBOL diode 496 -128 R0
SYMATTR InstName D1
SYMBOL diode 496 -64 R0
SYMATTR InstName D2
SYMBOL diode 496 0 R0
SYMATTR InstName D3
SYMBOL diode 496 64 R0
SYMATTR InstName D4
SYMBOL pnp 480 -176 M270
SYMATTR InstName Q1
SYMBOL res 336 -240 R0
SYMATTR InstName R5
SYMATTR Value 1k
SYMBOL res 576 -144 R0
SYMATTR InstName R6
SYMATTR Value 330
SYMBOL LED 576 -48 R0
SYMATTR InstName D5
SYMBOL res 400 144 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R7
SYMATTR Value 20k
SYMBOL res 736 -128 R0
SYMATTR InstName R8
SYMATTR Value 20k
SYMBOL res 736 -16 R0
SYMATTR InstName R11
SYMATTR Value 20k
SYMBOL diode 960 -128 R0
SYMATTR InstName D6
SYMBOL diode 960 -64 R0
SYMATTR InstName D7
SYMBOL diode 960 0 R0
SYMATTR InstName D8
SYMBOL diode 960 64 R0
SYMATTR InstName D14
SYMBOL pnp 944 -176 M270
SYMATTR InstName Q2
SYMBOL res 800 -240 R0
SYMATTR InstName R12
SYMATTR Value 1k
SYMBOL res 1040 -144 R0
SYMATTR InstName R14
SYMATTR Value 330
SYMBOL LED 1040 -48 R0
SYMATTR InstName D15
SYMBOL res 864 144 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R15
SYMATTR Value 20k
SYMBOL res -416 416 R0
SYMATTR InstName R16
SYMATTR Value 20k
SYMBOL res -416 528 R0
SYMATTR InstName R17
SYMATTR Value 20k
SYMBOL res -288 688 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R20
SYMATTR Value 15k
SYMBOL nmos -144 464 R0
SYMATTR InstName M1
SYMBOL pmos -176 352 R270
SYMATTR InstName M2
SYMBOL res 16 352 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R19
SYMATTR Value 100k
SYMBOL res -112 544 R0
SYMATTR InstName R18
SYMATTR Value 1000k
SYMBOL nmos 432 480 R0
SYMATTR InstName M3
SYMBOL pmos 400 368 R270
SYMATTR InstName M4
SYMBOL res 592 368 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R22
SYMATTR Value 100k
SYMBOL res 464 560 R0
SYMATTR InstName R23
SYMATTR Value 1000k
SYMBOL nmos 896 480 R0
SYMATTR InstName M5
SYMBOL pmos 864 368 R270
SYMATTR InstName M6
SYMBOL res 1056 368 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R24
SYMATTR Value 100k
SYMBOL res 928 560 R0
SYMATTR InstName R25
SYMATTR Value 1000k
SYMBOL voltage 80 304 R270
WINDOW 0 32 56 VTop 2
WINDOW 3 -32 56 VBottom 2
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V2
SYMATTR Value 4.2
SYMBOL voltage 576 304 R270
WINDOW 0 32 56 VTop 2
WINDOW 3 -32 56 VBottom 2
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V3
SYMATTR Value 4.2
SYMBOL voltage 1040 304 R270
WINDOW 0 32 56 VTop 2
WINDOW 3 -32 56 VBottom 2
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V4
SYMATTR Value 4.2
SYMBOL TL431 -240 448 M0
SYMATTR InstName U2
SYMBOL TL431 -16 -96 M0
SYMATTR InstName U3
SYMBOL LM317 304 864 R180
SYMATTR InstName U4
SYMBOL res 320 768 R180
WINDOW 0 36 76 Left 2
WINDOW 3 36 40 Left 2
SYMATTR InstName R21
SYMATTR Value 4.7k
SYMBOL res 144 880 R180
WINDOW 0 36 76 Left 2
WINDOW 3 36 40 Left 2
SYMATTR InstName R26
SYMATTR Value 550
SYMBOL res -464 912 R270
WINDOW 0 32 56 VTop 2
WINDOW 3 0 56 VBottom 2
SYMATTR InstName R27
SYMATTR Value 2
SYMBOL TL431 432 -80 M0
SYMATTR InstName U1
SYMBOL TL431 896 -80 M0
SYMATTR InstName U5
SYMBOL res 672 880 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R28
SYMATTR Value 1k
TEXT -616 1160 Left 2 !.tran 0 0.1 0 0.001 startup
TEXT -608 1272 Left 2 !,include C:\\Users\\gallo.HOTMETAL\\Documents\\LTspiceXVII\\lib\\tl431.mod
TEXT -608 1208 Left 2 !.model A D(Ron=1 Roff=1Meg Vfwd=1 Vrev=2)
